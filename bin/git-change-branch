#!/bin/bash

set -eo pipefail

if [ ! -e ~/.git_history ]; then
  mkdir -p ~/.git_history
fi

history_file=~/.git_history/$(git rev-parse --show-toplevel | sed "s@^$HOME/@@" | sed 's@/@%2F@g')

git checkout $@
branch=$(git symbolic-ref HEAD 2> /dev/null) || exit 0
sed -i '' -e "\\@^$branch @d" "$history_file"
echo "$branch $(date +%s)" >> "$history_file"
